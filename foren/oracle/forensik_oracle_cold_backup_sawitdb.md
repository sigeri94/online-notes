# Forensik Oracle Database (Cold Backup)

Dokumen ini menjelaskan **prosedur forensik Oracle menggunakan metode cold backup** dengan studi kasus database **SAWITDB**. Pendekatan ini bersifat **read-only / non-intrusive**, cocok untuk kebutuhan investigasi (fraud, insider threat, unauthorized access).

---

## 1. Artefak yang Dikopi dari Sistem Sumber

Pastikan database **SAWITDB** dalam kondisi shutdown normal.

### 1.1 Direktori Database

- `D:\ORACLEDB\SAWITDB`
  - datafile (`*.dbf`)
  - controlfile (`control*.ctl`)
  - redo log (`redo*.log`)

### 1.2 Direktori Admin

- `D:\ORACLEDB\admin\SAWITDB`
  - `pfile` (init.ora)
  - `adump` (audit trail OS)
  - `bdump / cdump / trace`
  - `dpdump`

---

## 2. Persiapan Environment Forensik

### 2.1 Install Oracle Software

- Versi Oracle **harus sama** dengan sistem sumber (contoh: Oracle 19c)
- Mode **Standalone / Forensic Lab**

### 2.2 Buat Oracle Service (Windows)

Gunakan `oradim` untuk membuat instance service:

```bat
oradim -new ^
  -sid SAWITDB ^
  -startmode manual ^
  -pfile D:\ORACLEDB\admin\SAWITDB\pfile\init.ora.10112024102819
```
## 3. Jika ingin remote login 

### 3.1 Pastikan sqlnet.ora NONE
```bat
SQLNET.AUTHENTICATION_SERVICES= (NONE)
```
reset password sys pastikan remote login pass exclusive
```sql
SQL> ALTER USER sys IDENTIFIED BY "Password1$";

SQL> show parameter remote_login_passwordfile;

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
remote_login_passwordfile            string      EXCLUSIVE
```
### 3.2 set juga listener.ora
```bat
# listener.ora Network Configuration File: D:\oracle_win\NETWORK\ADMIN\listener.ora
# Generated by Oracle configuration tools.

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )


SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = CLRExtProc)
      (ORACLE_HOME = D:\oracle_win)
      (PROGRAM = extproc)
      (ENVS = "EXTPROC_DLLS=ONLY:D:\oracle_win\bin\oraclr19.dll")
    )
    (SID_DESC =
      (GLOBAL_DBNAME = SAWITDB)
      (ORACLE_HOME = D:\oracle_win)
      (SID_NAME = SAWITDB)
    )
  )

```
### 3.3 set juga tnsname.ora
```sql
# tnsnames.ora Network Configuration File: D:\oracle_win\NETWORK\ADMIN\tnsnames.ora
# Generated by Oracle configuration tools.

LISTENER_ORCL2 =
  (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))


ORACLR_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
    (CONNECT_DATA =
      (SID = CLRExtProc)
      (PRESENTATION = RO)
    )
  )

SAWITDB =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.0.206)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = SAWITDB)
    )
  )
```
Testing
```sql
C:\Users\batman>sqlplus sys/"Password1$"@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.0.206)(PORT=1521))(CONNECT_DATA=(SID=RTSX))) as sysdba
```
### 3.4 Set Environment Variable

```bat
set ORACLE_SID=SAWITDB
```

Pastikan:
- `ORACLE_HOME` benar
- Path `init.ora` sesuai dengan lokasi hasil copy

---

## 4. Proses Startup Database Forensik

Masuk ke SQL*Plus sebagai SYSDBA:

```sql
sqlplus / as sysdba
```

### 4.1 Startup Nomount

```sql
startup nomount pfile='D:\ORACLEDB\admin\SAWITDB\pfile\init.ora.10112024102819';
```

### 4.2 Mount Database

```sql
alter database mount;
```

### 4.3 Open Database

```sql
alter database open;
```

> ðŸ”Ž Jika tujuan hanya analisa metadata dan audit, **mount saja sudah cukup**.

---

## 5. Pembuatan SPFILE (Opsional)

Untuk stabilitas instance forensik:

```sql
create spfile from pfile='D:\ORACLEDB\admin\SAWITDB\pfile\init.ora.10112024102819';
```

---

## 6. Setup SQL*Plus untuk Analisa Forensik

```sql
SET PAGES 50000
SET LINES 200
col dbusername for a15
col userhost   for a30
col action_name for a15
col event_timestamp for a25
```

---

## 7. Analisa Audit Login (Unified Audit Trail)

### 7.1 Tujuan

- Mengidentifikasi **login & logoff user**
- Menentukan **waktu, user, dan host asal**
- Korelasi dengan insiden fraud

### 7.2 Query Audit Login

```sql
SELECT
    TO_CHAR(event_timestamp, 'YYYY-MM-DD HH24:MI:SS') AS event_time,
    dbusername,
    userhost,
    action_name
FROM unified_audit_trail
WHERE event_timestamp >= TO_TIMESTAMP('2024-12-04 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
  AND event_timestamp <  TO_TIMESTAMP('2025-12-05 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
  AND action_name IN ('LOGON', 'LOGOFF')
ORDER BY event_timestamp ASC;
```
```sql
SELECT 
TO_CHAR(event_timestamp,'YYYY-MM-DD HH24:MI:SS') event_time,
    dbusername,
    userhost,
    os_username,
    client_program_name,ACTION_NAME,sql_text
FROM unified_audit_trail
WHERE event_timestamp >= TO_TIMESTAMP('2025-10-01 00:00:00','YYYY-MM-DD HH24:MI:SS');
```


